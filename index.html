<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>k-means exercise</title>
        <!--<link rel="stylesheet" type="text/css" href="./css/main.css">-->
        <script type="text/javascript" src="./js/point-diagram.js"></script>
        <script type="text/javascript" src="./js/point.js"></script>
        <script type="text/javascript" src="./js/dataset.js"></script>
        <script type="text/javascript" src="./js/exercise-manager.js"></script>
        <script type="text/javascript" src="./js/k-means.js"></script>
        <script type="text/javascript" src="./js/cluster.js"></script>
        <style type="text/css">
            .axis path,
            .axis line {
                fill: none;
                stroke: grey;
                shape-rendering: crispEdges;
            }
            .axis text {
                font-family: sans-serif;
                font-size: small;
            }
        </style>
        <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script language="javascript" type="text/javascript">
            var iter = 0;
            var manager = new ExerciseManager();
            var dataset = null;
            
            var prvK = -1;
            var prvDistribution = "";
            
            // 縦・横のピクセル数
            var fieldWidth = 500;
            var fieldHeight = 500;

            var prvIcd = -99;
            var countSame = 0;

            function onClickRestart() {
                document.getElementById("step").disabled = "";
                prvIcd = -99;
                countSame = 0;
                document.getElementById("icd").innerHTML = "<b>Average inner cluster distance:</b>";

                var curK = parseInt(document.getElementById("k").value);
                var curDistribution = document.getElementById("distribution").value;
                if (curK != prvK || curDistribution != prvDistribution) {
                    manager.removeSvg();
                    manager.createSvg(fieldWidth, fieldHeight, curDistribution);
                }
                manager.initialize(curK);
                prvK = curK;
                prvDistribution = curDistribution;
            };

            function onClickStep() {
                var icd = manager.step();
                document.getElementById("icd").innerHTML = "<b>Average inner cluster distance: " + icd.toFixed(3) + "</b>";
                if (icd == prvIcd) {
                    ++countSame;
                    if (countSame >= 2) {
                        document.getElementById("step").disabled = "true";
                    }
                } else {
                    countSame = 0;
                }
                prvIcd = icd;
            };
        </script>
    </head>
    <body>
        <h1>k-means exercise</h1>
        <p>
            Distribution
            <select name="distribution" size=1 id="distribution" onchange="onClickRestart()">
                <option value=uniform>Uniform</option>
                <option value=gaussian>Gaussian</option>
                <option value=3gaussians>3 Gaussians</option>
                <option value=3circles>3 Circles</option>
                <option value=separated>Separated</option>
            </select>
        </p>
        <p>
            Number of clusters
            <select name="k" size=1 id="k" onchange="onClickRestart()">
                <option value=2>2</option>
                <option value=3>3</option>
                <option value=4>4</option>
                <option value=5>5</option>
            </select>
        </p>
        <p>
            <button name="restart" id="restart" onclick="onClickRestart()">Restart</button>
            <button name="step" id="step" onclick="onClickStep()">Step</button>
        </p>
        <p>
            <div id="icd"><b>Average inner cluster distance:</b></div>
        </p>
        <script>
            onClickRestart();
        </script>
    </body>
</html>
